# Отчет по лабораторной работе 
## по курсу "Искусственый интеллект"

## Нейросетям для распознавания изображений


### Студенты: 

| ФИО       | Роль в проекте                     | Оценка       |
|-----------|------------------------------------|--------------|
| Ногаев Д.Т. | Подготовил датасет. Обучил нейросети |          |
| Петросян В.А. | Обучил нейросети |       |
| Хасанов А.Р.| Написал отчёт |      |

## Результат проверки

| Преподаватель     | Дата         |  Оценка       |
|-------------------|--------------|---------------|
| Сошников Д.В. |     19.06.2020         |      4         |

> *Результаты обучения не проанализированы на переобучение или недообучение. Опоздание в сроках сдачи работы. Хороший код для автоматизации процесс обрезки исходных изображений.*

## Тема работы

Построение нейросетевых классификаторов для распознавания рукописных символов, галочки и крестика.

## Распределение работы в команде
Как и в случае с прошлой лабораторной работой мы собрались в Discord и вместе разбирались, над тем как именно работают нейронные сети .
## Подготовка данных
Исходное изображение: 

Примеры изображений галочки:https://github.com/MAILabs-Edu-AI/lab-neural-networks-vision-next-level-upgrade/blob/master/check1.jpg

Примеры изображений крестиков:https://github.com/MAILabs-Edu-AI/lab-neural-networks-vision-next-level-upgrade/blob/master/plus1.jpg:

При подготовки датасета, каждый участник использовал камеру своего телефона. Отбирали лучшие фотографии и далее обрезали их. И в конце мы реализовали разрезку изображений


## Загрузка данных
Данные, получаемые в условиях реального мира, не всегда имеют тот формат, который наиболее удобен для осуществления дальнейшей обработки. Обрезка клеточек стандартного листа при помощи статической обрезки (случай, в котором предполагается конкретное фиксированное расположение разметки листа) дает плохие результаты даже при хорошем качестве фотографии. В реальном мире снимки могут иметь мелкие дефекты и высокочастотные шумы. К аналогичным факторам можно отнести сьемку под углом, при которой подход со статической обрезкой фотографии даст абсолютно непригодные для обработки фрагменты тестовых данных. Включая во внимание вышеуказанные факторы, было принято решение использовать возможности библиотеки OpenCV для автоматической обрезки ячеек, путем обнаружения квадратных контуров на изображении. Эта подход максимально улучшил качество тестовых фрагментов, а также позволил отказаться от точной обрезки фотографий. Эффективность и качество такого подхода демонстрируют фрагменты рукописных символов, представленные в ноутбуке.\
def load_data(name):\
    image = cv2.imread(name, cv2.IMREAD_GRAYSCALE)\
    result = box_extraction(image)\
    for i, e in enumerate(result):\
        result[i] = cv2.resize(e, (32,32))\
    return result

## Обучение нейросети

### Полносвязная однослойная сеть
**Архитектура**
Самым простым видом нейронной сети является однослойная сеть персептрона, которая состоит из одного слоя выходных узлов и входы которой идут непосредственно на выходы через серию весов. Сумма произведений весов и входов рассчитывается в каждом узле, и если значение превышает некоторый порог (0), нейрон срабатывает и принимает активированное значение (1); в противном случае он принимает деактивированное значение (1)\
**Результаты**\
In [13]:\
dense_model_1.evaluate(x_test, y_test)\
6/6 [==============================] - 0s 744us/step - loss: 0.3777 - accuracy: 0.9895\
Out[13]:\
[0.3777267336845398, 0.9894737005233765]

### Полносвязная многослойная сеть
**Архитектура** 
Слой содержит совокупность нейронов с едиными входными сигналами. Число нейронов в слое может быть любым и не зависит от количества нейронов в других слоях. В общем случае сеть состоит из Q слоев, пронумерованных слева направо. Внешние входные сигналы подаются на входы нейронов входного слоя (его часто нумеруют как нулевой), а выходами сети являются выходные сигналы последнего слоя. Кроме входного и выходного слоев в многослойной нейронной сети есть один или несколько скрытых слоев.\

**Результаты**\
In [15]:\
dense_model_2.evaluate(x_test, y_test)\
6/6 [==============================] - 0s 1ms/step - loss: 0.4451 - accuracy: 1.0000\
Out[15]:\
[0.4450799524784088, 1.0]

### Свёрточная сеть
**Архитектура**
Сеть состоит из большого количества слоёв. Первый слой всегда свёрточный.В сверточной нейронной сети выходы промежуточных слоев образуют матрицу (изображение) или набор матриц (несколько слоёв изображения). Так, например, на вход сверточной нейронной сети можно подавать три слоя изображения (R-, G-, B-каналы изображения). Основными видами слоев в сверточной нейронной сети являются сверточные слои (англ. convolutional layer), пулинговые слои (англ. pooling layer) и полносвязные слои (англ. fully-connected layer).

**Результаты**\
In [14]:convolutional_model.evaluate(x_test, y_test)\
6/6 [==============================] - 0s 2ms/step - loss: 0.0433 - accuracy: 0.9842\
Out[14]:\
[0.04326535388827324, 0.9842105507850647]\


## Выводы
Данная лабораторная работа помогла нашей команде освоить обработку изображений с помощью opencv и создание датасетов, а также обучение нейросети. Проделанная работа заставила задуматься над тем, что нейронные сети имеют огромные возможности.Правильное применение нейронных сетей может значительно облегчить работу многих людей и организаций, так как их можно применять для решения поставленных задач во многих сферах. Весь этап разработки мы взаимодействовали в команде. Для ускорения процесса разработки мы несколько раз встречались дискорде, а также освоили технологию совместного редактирования кода в Visual Studio Code.

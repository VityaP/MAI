Вариант 1
Получить таблицу групп и средний балл по каждой из групп
Для каждого предмета получить список студентов, не сдавших экзамен (grade=2)
Найти количество не сдавших студентов в каждой из групп